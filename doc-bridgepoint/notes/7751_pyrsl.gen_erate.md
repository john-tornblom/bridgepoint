---

This work is licensed under the Creative Commons CC0 License

---

# pyrsl as a replacement for gen_erate.exe
### xtUML Project Analysis Note

1. Abstract
-----------
The BridgePoint toolchain currently rely on a windows-only interpreter called gen_erate.exe to execute RSL archetype files. To execute these parts of the tool chain on a non-windows machine, wine must be used. Rather than using wine, an experimental interpreter called pyrsl [1] may be used instead. This note aims to investigate if pyrsl is feasable as a replacement to gen_erate.exe.

2. Document References
----------------------
[1] [pyrsl github page](https://github.com/john-tornblom/pyrsl)  
[2] [self contained python version of gen_erate](https://github.com/john-tornblom/pyrsl/raw/bindist/gen_erate)  
[3] [python-based replacement of the perl script xtumlmc_build](https://raw.githubusercontent.com/john-tornblom/mc/master/bin/mc3020.py)   
[4] [BridgePoint DEI 7751](https://support.onefact.net/redmine/issues/7751)   
[5] [GPL v3](http://www.gnu.org/licenses/gpl-3.0.en.html)   
[6] [Apache License, Version 2.0](http://www.apache.org/licenses/LICENSE-2.0)   
[7] [GPS Watch diff](http://pastebin.com/Mx4JkdD2)   

3. Background
-------------
In its current condition, pyrsl behaves much like the original gen_erate.exe. A self-contained python-based version of gen_erate is availale for download [2] which uses a command line interface (CLI) with looks just like the original.  

A more modern CLI is also available, which exposes additional features not available in gen_erate.exe:  
 **--include**    Similar to the gcc -I flag and the #include directive, pyrsl may search for a file is several places when using .include "filename". When the same filename is available in several paths, the one provided first on CLI will be used.  
 **--emit=WHEN**  choose when to emit a buffer to disk (never, when the files differ, always)  
 **--force**    make read-only emit files writable, i.e. chmod +w  
 **--diff=PATH**   generate a diff/patch between the text located on disk before every emit, and the emited text.

#### 3.1 Licensing ####
Like bash, pyrsl is licenced under the GPLv3 [5]. Unlike the Apache 2 [6] license which most of BridgePoint is licenced under, GPLv3 requires any distributor to also distribute the source code. In addition, derived work must be made available to any reciever under the same licence as the orignal work. Of cource, source code which is interpreted by pyrsl (or bash) is not affected.

Just like the Apache license, GPL licensed software is provided without warranty and the software author/license owner cannot be held liable for damages.

4. Requirements
---------------
4.1  Given a project "X", the source code created by the Build Project action shall be identical when using the current gen_erate.exe and the pyrsl version of gen_erate.exe on both Windows and Linux.   
4.2  The pyrsl version of gen_erate.exe shall handle all of the command line arguments that are handled by the current gen_erate.exe.   
4.3  pyrsl memory usage shall be equal to or less than the memory usage of gen_erate.exe on Windows or Wine+gen_enerate.exe on Linux.   
4.4  pyrsl execution time shall be equal to or less than the execution time of gen_erate.exe.   

5. Analysis
-----------
The windows version of gen_erate is wrapped with a perl-script which modifies the sql-file generated from the prebuilder in various ways. For example:
* remove the (') symbol from all phrases
* change all uuid values to integer values
* copy archetype files from the /sysc or /c folder into the project folder

With pyrsl, some of these modifications are unessecary, and some may done in a more robust way [3].
Note: The current version of the python script [3] does not generate a makefile.

the emitted source code is currently not 100% identical to the source code generated by gen_erate.exe.
see [7] for a diff on the GPS watch project. Know difference include:
* additional line breaks in some cases
* some differences in the ordering of instances in a set

6. Work Required
----------------
Decide on which approach is most suitable:  
  
6.1 Create a drop-in replacement for gen_erate.exe, and use the existing wrapper written in perl.
* add gen_erate to packing
* update perl scripts which invoke gen_erate.exe using wine to point at gen_erate instead.  
  
6.2 Replace the perl-script with a python script
* come up with a viable solution for windows users
* come up with a good way for generating a makefile

7. Acceptance Test
------------------
7.1  Create table to side-by-side compare memory and processing times for models.  Primarily use xtuml/models repo (GPS Watch, OOAofOOA, ex1) but also in-house models (with obfuscated names).   
7.2  Create a build test to verify command line arguments.   

End
---


